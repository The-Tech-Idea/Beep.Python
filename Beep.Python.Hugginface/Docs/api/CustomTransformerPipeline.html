<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CustomTransformerPipeline API - Beep.Python.AI.Transformers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <link href="../assets/styles.css" rel="stylesheet">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="bi bi-sun-fill" id="theme-icon"></i>
    </button>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Navigation will be loaded dynamically by navigation.js -->
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb Navigation -->
                <div class="breadcrumb-nav">
                    <a href="../index.html">Home</a>
                    <span>�</span>
                    <a href="../index.html#core-api">Core API</a>
                    <span>�</span>
                    <span>CustomTransformerPipeline</span>
                </div>

                <!-- Page Header -->
                <div class="page-header">
                    <h1><i class="bi bi-gear-fill"></i> CustomTransformerPipeline Class</h1>
                    <p class="page-subtitle">Flexible pipeline implementation for custom model sources, APIs, and specialized workflows</p>
                </div>

                <!-- Class Info -->
                <div class="class-info">
                    <div class="class-namespace">
                        <strong>Namespace:</strong> Beep.Python.AI.Transformers<br>
                        <strong>Assembly:</strong> Beep.Python.AI.Transformers.dll<br>
                        <strong>Package:</strong> Beep.Python.AI.Transformers
                    </div>
                    <div class="class-implements">
                        <strong>Inheritance:</strong> BaseTransformerPipeline ? CustomTransformerPipeline<br>
                        <strong>Implements:</strong> ITransformerPipeLine, IDisposable
                    </div>
                </div>

                <!-- Overview Section -->
                <section class="section" id="overview">
                    <h2>?? Overview</h2>
                    <p>
                        The <code>CustomTransformerPipeline</code> class provides the ultimate flexibility for integrating AI models from any source. 
                        It supports custom APIs, local models, URL-based models, and custom scripts, making it the go-to choice for specialized 
                        use cases and proprietary model sources.
                    </p>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4><i class="bi bi-cloud"></i> API Integration</h4>
                            <p>Connect to custom REST APIs and proprietary services</p>
                        </div>
                        <div class="feature-card">
                            <h4><i class="bi bi-hdd"></i> Local Models</h4>
                            <p>Load models from local directories and file systems</p>
                        </div>
                        <div class="feature-card">
                            <h4><i class="bi bi-link-45deg"></i> URL Sources</h4>
                            <p>Download and use models from remote URLs</p>
                        </div>
                        <div class="feature-card">
                            <h4><i class="bi bi-code-slash"></i> Custom Scripts</h4>
                            <p>Execute custom Python code for specialized processing</p>
                        </div>
                    </div>
                </section>

                <!-- Constructor Section -->
                <section class="section" id="constructor">
                    <h2>?? Constructor</h2>
                    
                    <div class="code-example">
                        <h4>CustomTransformerPipeline(IPythonRunTimeManager, IPythonCodeExecuteManager)</h4>
                        <pre><code class="language-csharp">public CustomTransformerPipeline(
    IPythonRunTimeManager pythonRunTimeManager,
    IPythonCodeExecuteManager executeManager
)</code></pre>
                        <h5>Parameters</h5>
                        <ul>
                            <li><code>pythonRunTimeManager</code> - Python runtime management interface</li>
                            <li><code>executeManager</code> - Python code execution interface</li>
                        </ul>
                    </div>
                </section>

                <!-- Methods Section -->
                <section class="section" id="methods">
                    <h2>?? Methods</h2>

                    <!-- InitializeAsync -->
                    <div class="method">
                        <h3>InitializeAsync</h3>
                        <pre><code class="language-csharp">public override async Task&lt;bool&gt; InitializeAsync(TransformerPipelineConfig config)</code></pre>
                        <p>Initializes the custom pipeline with flexible configuration options.</p>
                        
                        <h4>Configuration Options</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Key</th>
                                    <th>Type</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>required_packages</code></td>
                                    <td>string[]</td>
                                    <td>Python packages to install</td>
                                </tr>
                                <tr>
                                    <td><code>custom_imports</code></td>
                                    <td>string</td>
                                    <td>Additional Python import statements</td>
                                </tr>
                                <tr>
                                    <td><code>environment_variables</code></td>
                                    <td>Dictionary</td>
                                    <td>Environment variables to set</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- LoadModelAsync -->
                    <div class="method">
                        <h3>LoadModelAsync</h3>
                        <pre><code class="language-csharp">public override async Task&lt;bool&gt; LoadModelAsync(
    TransformerModelInfo modelInfo, 
    TransformerTask taskType, 
    Dictionary&lt;string, object&gt;? modelConfig = null
)</code></pre>
                        <p>Loads models from various custom sources based on configuration.</p>
                        
                        <h4>Supported Model Sources</h4>
                        <ul>
                            <li><strong>API Sources:</strong> REST APIs, webhooks, custom endpoints</li>
                            <li><strong>Local Sources:</strong> File system paths, directories</li>
                            <li><strong>URL Sources:</strong> Download from remote URLs</li>
                            <li><strong>Script Sources:</strong> Custom Python execution</li>
                            <li><strong>HuggingFace with Custom Config:</strong> Enhanced HuggingFace integration</li>
                        </ul>
                    </div>

                    <!-- GenerateTextAsync -->
                    <div class="method">
                        <h3>GenerateTextAsync</h3>
                        <pre><code class="language-csharp">public override async Task&lt;TransformerResult&lt;string&gt;&gt; GenerateTextAsync(
    string prompt, 
    TextGenerationParameters? parameters = null
)</code></pre>
                        <p>Generates text using the loaded custom model with flexible parameter handling.</p>
                    </div>

                    <!-- InferenceAsync -->
                    <div class="method">
                        <h3>InferenceAsync</h3>
                        <pre><code class="language-csharp">public override async Task&lt;TransformerResult&lt;object&gt;&gt; InferenceAsync(
    object inputs, 
    Dictionary&lt;string, object&gt;? parameters = null
)</code></pre>
                        <p>Performs generic inference with any input type and flexible parameter handling.</p>
                    </div>

                    <!-- GetSupportedTasks -->
                    <div class="method">
                        <h3>GetSupportedTasks</h3>
                        <pre><code class="language-csharp">public override List&lt;TransformerTask&gt; GetSupportedTasks()</code></pre>
                        <p>Returns all transformer tasks since custom pipeline supports any task type.</p>
                    </div>
                </section>

                <!-- Usage Examples -->
                <section class="section" id="examples">
                    <h2>?? Usage Examples</h2>

                    <!-- API Model Example -->
                    <div class="example">
                        <h3>1. Custom API Integration</h3>
                        <p>Connect to a custom REST API model service:</p>
                        <pre><code class="language-csharp">// Configure custom API pipeline
var config = new TransformerPipelineConfig
{
    CustomConfig = new Dictionary&lt;string, object&gt;
    {
        ["required_packages"] = new[] { "requests", "aiohttp" }
    }
};

var customPipeline = new CustomTransformerPipeline(runtimeManager, executeManager);
await customPipeline.InitializeAsync(config);

// Load API model
var modelInfo = new TransformerModelInfo
{
    Name = "MyCustomAPI",
    Source = TransformerModelSource.Custom,
    ModelPath = "https://api.mycompany.com/v1/generate"
};

var modelConfig = new Dictionary&lt;string, object&gt;
{
    ["api_endpoint"] = "https://api.mycompany.com/v1/generate",
    ["api_key"] = "your-api-key",
    ["headers"] = new Dictionary&lt;string, string&gt;
    {
        ["Content-Type"] = "application/json",
        ["User-Agent"] = "MyApp/1.0"
    }
};

await customPipeline.LoadModelAsync(modelInfo, TransformerTask.TextGeneration, modelConfig);

// Generate text
var result = await customPipeline.GenerateTextAsync("Explain quantum computing", 
    new TextGenerationParameters 
    { 
        MaxLength = 200,
        Temperature = 0.7 
    });

Console.WriteLine($"Generated: {result.Data}");
</code></pre>
                    </div>

                    <!-- Local Model Example -->
                    <div class="example">
                        <h3>2. Local Model Loading</h3>
                        <p>Load and use a local model from the file system:</p>
                        <pre><code class="language-csharp">// Configure for local model
var config = new TransformerPipelineConfig
{
    CustomConfig = new Dictionary&lt;string, object&gt;
    {
        ["required_packages"] = new[] { "torch", "transformers" }
    }
};

var customPipeline = new CustomTransformerPipeline(runtimeManager, executeManager);
await customPipeline.InitializeAsync(config);

// Load local model
var modelInfo = new TransformerModelInfo
{
    Name = "LocalLlama",
    Source = TransformerModelSource.Local,
    ModelPath = @"C:\Models\llama-7b-chat"
};

var modelConfig = new Dictionary&lt;string, object&gt;
{
    ["config_path"] = @"C:\Models\llama-7b-chat\config.json",
    ["torch_dtype"] = "float16",
    ["device_map"] = "auto"
};

await customPipeline.LoadModelAsync(modelInfo, TransformerTask.TextGeneration, modelConfig);

// Generate text
var result = await customPipeline.GenerateTextAsync("Write a Python function to calculate fibonacci");
</code></pre>
                    </div>

                    <!-- Custom Script Example -->
                    <div class="example">
                        <h3>3. Custom Script Execution</h3>
                        <p>Use custom Python scripts for specialized processing:</p>
                        <pre><code class="language-csharp">// Configure custom script pipeline
var config = new TransformerPipelineConfig
{
    CustomConfig = new Dictionary&lt;string, object&gt;
    {
        ["custom_imports"] = @"
import pandas as pd
import numpy as np
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.metrics.pairwise import cosine_similarity"
    }
};

var customPipeline = new CustomTransformerPipeline(runtimeManager, executeManager);
await customPipeline.InitializeAsync(config);

// Load custom script model
var modelInfo = new TransformerModelInfo
{
    Name = "CustomTextSimilarity",
    Source = TransformerModelSource.Custom
};

var modelConfig = new Dictionary&lt;string, object&gt;
{
    ["custom_script"] = @"
# Custom similarity computation
vectorizer = TfidfVectorizer()

def custom_inference(input_data, parameters=None):
    texts = input_data if isinstance(input_data, list) else [input_data]
    
    # Compute TF-IDF vectors
    tfidf_matrix = vectorizer.fit_transform(texts)
    
    # Calculate similarity
    similarity_matrix = cosine_similarity(tfidf_matrix)
    
    return {
        'similarity_scores': similarity_matrix.tolist(),
        'vectorizer_vocab': len(vectorizer.vocabulary_),
        'method': 'TF-IDF + Cosine Similarity'
    }"
};

await customPipeline.LoadModelAsync(modelInfo, TransformerTask.SimilarityComparison, modelConfig);

// Perform inference
var texts = new[] { "Hello world", "Hi there", "Goodbye" };
var result = await customPipeline.InferenceAsync(texts);
</code></pre>
                    </div>

                    <!-- URL Model Example -->
                    <div class="example">
                        <h3>4. Model from URL</h3>
                        <p>Download and use a model from a remote URL:</p>
                        <pre><code class="language-csharp">// Configure URL download pipeline
var config = new TransformerPipelineConfig();

var customPipeline = new CustomTransformerPipeline(runtimeManager, executeManager);
await customPipeline.InitializeAsync(config);

// Load model from URL
var modelInfo = new TransformerModelInfo
{
    Name = "RemoteModel",
    Source = TransformerModelSource.Custom,
    ModelPath = "https://github.com/user/model/releases/download/v1.0/model.zip"
};

var modelConfig = new Dictionary&lt;string, object&gt;
{
    ["download_path"] = "./downloaded_models/remote_model",
    ["extract_format"] = "zip"
};

await customPipeline.LoadModelAsync(modelInfo, TransformerTask.TextGeneration, modelConfig);

// Use the downloaded model
var result = await customPipeline.GenerateTextAsync("Generate a creative story");
</code></pre>
                    </div>
                </section>

                <!-- Configuration Guide -->
                <section class="section" id="configuration">
                    <h2>?? Configuration Guide</h2>

                    <!-- Model Type Detection -->
                    <div class="config-section">
                        <h3>Model Type Detection</h3>
                        <p>The pipeline automatically detects model types based on configuration:</p>
                        
                        <table>
                            <thead>
                                <tr>
                                    <th>Type</th>
                                    <th>Detection Criteria</th>
                                    <th>Required Config</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>API</strong></td>
                                    <td>Contains <code>api_endpoint</code> or <code>api_key</code></td>
                                    <td>api_endpoint, api_key, headers</td>
                                </tr>
                                <tr>
                                    <td><strong>URL</strong></td>
                                    <td>ModelPath starts with "http"</td>
                                    <td>download_path, extract_format</td>
                                </tr>
                                <tr>
                                    <td><strong>Local</strong></td>
                                    <td>ModelPath exists as file/directory</td>
                                    <td>config_path (optional)</td>
                                </tr>
                                <tr>
                                    <td><strong>Script</strong></td>
                                    <td>Contains <code>custom_script</code></td>
                                    <td>custom_script code</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- API Configuration -->
                    <div class="config-section">
                        <h3>API Model Configuration</h3>
                        <pre><code class="language-json">{
  "api_endpoint": "https://api.provider.com/v1/chat/completions",
  "api_key": "your-secret-key",
  "headers": {
    "Content-Type": "application/json",
    "Authorization": "Bearer your-token",
    "User-Agent": "MyApp/1.0"
  },
  "timeout": 30,
  "retry_attempts": 3
}</code></pre>
                    </div>

                    <!-- Local Model Configuration -->
                    <div class="config-section">
                        <h3>Local Model Configuration</h3>
                        <pre><code class="language-json">{
  "config_path": "/path/to/model/config.json",
  "torch_dtype": "float16",
  "device_map": "auto",
  "load_in_8bit": true,
  "trust_remote_code": true,
  "cache_dir": "/path/to/cache"
}</code></pre>
                    </div>

                    <!-- Custom Script Configuration -->
                    <div class="config-section">
                        <h3>Custom Script Configuration</h3>
                        <pre><code class="language-json">{
  "custom_script": "
# Your Python code here
def custom_inference(input_data, parameters=None):
    # Process input_data
    result = process_input(input_data)
    return result
",
  "script_globals": {
    "model_path": "/path/to/resources",
    "config": {"param1": "value1"}
  }
}</code></pre>
                    </div>
                </section>

                <!-- Best Practices -->
                <section class="section" id="best-practices">
                    <h2>? Best Practices</h2>

                    <div class="tip">
                        <h4>?? Security Considerations</h4>
                        <ul>
                            <li><strong>API Keys:</strong> Never hardcode API keys in source code</li>
                            <li><strong>URL Downloads:</strong> Validate URLs and use HTTPS when possible</li>
                            <li><strong>Custom Scripts:</strong> Sanitize and validate custom Python code</li>
                            <li><strong>Local Paths:</strong> Verify file permissions and accessibility</li>
                        </ul>
                    </div>

                    <div class="warning">
                        <h4>? Performance Tips</h4>
                        <ul>
                            <li><strong>Caching:</strong> Cache frequently used models and configurations</li>
                            <li><strong>Resource Management:</strong> Monitor memory usage with large local models</li>
                            <li><strong>Async Operations:</strong> Use proper async/await patterns for I/O operations</li>
                            <li><strong>Error Handling:</strong> Implement robust error handling for network operations</li>
                        </ul>
                    </div>

                    <div class="note">
                        <h4>??? Architecture Guidelines</h4>
                        <ul>
                            <li><strong>Separation of Concerns:</strong> Keep configuration separate from business logic</li>
                            <li><strong>Dependency Injection:</strong> Use DI for runtime and execution managers</li>
                            <li><strong>Testing:</strong> Create mock implementations for unit testing</li>
                            <li><strong>Monitoring:</strong> Log important events and performance metrics</li>
                        </ul>
                    </div>
                </section>

                <!-- Navigation Links -->
                <div class="nav-links">
                    <a href="BaseTransformerPipeline.html" class="btn-beep">
                        <i class="bi bi-arrow-left"></i> BaseTransformerPipeline
                    </a>
                    <a href="TransformerPipelineFactory.html" class="btn-beep">
                        <i class="bi bi-arrow-right"></i> Pipeline Factory
                    </a>
                </div>

                <!-- Footer -->
                <footer class="documentation-footer">
                    <div class="footer-content">
                        <div class="footer-copyright">
                            <p>&copy; 2024 The Tech Idea - Beep.Python.AI.Transformers API Documentation</p>
                        </div>
                        <div class="footer-links">
                            <a href="../index.html">Home</a>
                            <a href="ITransformerPipeLine.html">ITransformerPipeLine</a>
                            <a href="TransformerPipelineFactory.html">Pipeline Factory</a>
                        </div>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="../assets/navigation.js"></script>
</body>
</html>