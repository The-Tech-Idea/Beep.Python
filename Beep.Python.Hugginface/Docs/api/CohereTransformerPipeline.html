<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CohereTransformerPipeline API - Beep.Python.AI.Transformers</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <link href="../assets/styles.css" rel="stylesheet">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="bi bi-sun-fill" id="theme-icon"></i>
    </button>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Navigation will be loaded dynamically by navigation.js -->
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb Navigation -->
                <div class="breadcrumb-nav">
                    <a href="../index.html">Home</a>
                    <span>›</span>
                    <a href="../index.html#core-api">Core API</a>
                    <span>›</span>
                    <span>CohereTransformerPipeline</span>
                </div>

                <!-- Page Header -->
                <div class="page-header">
                    <h1><i class="bi bi-layers-fill"></i> CohereTransformerPipeline Class</h1>
                    <p class="page-subtitle">High-performance language model integration with Cohere's enterprise-grade AI services</p>
                </div>

                <!-- Class Info -->
                <div class="class-info">
                    <div class="class-namespace">
                        <strong>Namespace:</strong> Beep.Python.AI.Transformers<br>
                        <strong>Assembly:</strong> Beep.Python.AI.Transformers.dll<br>
                        <strong>Package:</strong> Beep.Python.AI.Transformers
                    </div>
                    <div class="class-implements">
                        <strong>Inheritance:</strong> BaseTransformerPipeline ? CohereTransformerPipeline<br>
                        <strong>Implements:</strong> ITransformerPipeLine, IDisposable
                    </div>
                </div>

                <!-- Overview Section -->
                <section class="section" id="overview">
                    <h2>?? Overview</h2>
                    <p>
                        The <code>CohereTransformerPipeline</code> class provides seamless integration with Cohere's advanced language models. 
                        Cohere specializes in enterprise-ready natural language processing with models optimized for production use, 
                        offering exceptional performance in text generation, classification, embeddings, and semantic search.
                    </p>

                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4><i class="bi bi-lightning-charge"></i> High Performance</h4>
                            <p>Enterprise-grade models optimized for speed and accuracy</p>
                        </div>
                        <div class="feature-card">
                            <h4><i class="bi bi-search"></i> Semantic Search</h4>
                            <p>Advanced embedding models for similarity and search</p>
                        </div>
                        <div class="feature-card">
                            <h4><i class="bi bi-shield-check"></i> Enterprise Ready</h4>
                            <p>Production-ready with SLA guarantees and security</p>
                        </div>
                        <div class="feature-card">
                            <h4><i class="bi bi-globe"></i> Multilingual</h4>
                            <p>Support for 100+ languages with consistent quality</p>
                        </div>
                    </div>

                    <div class="highlight-box">
                        <h4>?? Cohere Model Capabilities</h4>
                        <ul>
                            <li><strong>Command Models:</strong> Advanced text generation and conversation</li>
                            <li><strong>Embed Models:</strong> High-quality semantic embeddings</li>
                            <li><strong>Classify Models:</strong> Zero-shot and few-shot classification</li>
                            <li><strong>Summarize Models:</strong> Intelligent content summarization</li>
                            <li><strong>Rerank Models:</strong> Advanced result ranking and relevance</li>
                        </ul>
                    </div>
                </section>

                <!-- Constructor Section -->
                <section class="section" id="constructor">
                    <h2>?? Constructor</h2>
                    
                    <div class="code-example">
                        <h4>CohereTransformerPipeline(IPythonRunTimeManager, IPythonCodeExecuteManager)</h4>
                        <pre><code class="language-csharp">public CohereTransformerPipeline(
    IPythonRunTimeManager pythonRunTimeManager,
    IPythonCodeExecuteManager executeManager
)</code></pre>
                        <h5>Parameters</h5>
                        <ul>
                            <li><code>pythonRunTimeManager</code> - Python runtime management interface</li>
                            <li><code>executeManager</code> - Python code execution interface</li>
                        </ul>
                    </div>
                </section>

                <!-- Methods Section -->
                <section class="section" id="methods">
                    <h2>?? Methods</h2>

                    <!-- InitializeAsync -->
                    <div class="method">
                        <h3>InitializeAsync</h3>
                        <pre><code class="language-csharp">public override async Task&lt;bool&gt; InitializeAsync(TransformerPipelineConfig config)</code></pre>
                        <p>Initializes the Cohere pipeline and installs required Python packages.</p>
                        
                        <h4>Required Configuration</h4>
                        <table>
                            <thead>
                                <tr>
                                    <th>Setting</th>
                                    <th>Required</th>
                                    <th>Description</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>api_key</code></td>
                                    <td>?</td>
                                    <td>Cohere API key for authentication</td>
                                </tr>
                                <tr>
                                    <td><code>base_url</code></td>
                                    <td>?</td>
                                    <td>Custom API endpoint (for enterprise)</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- LoadModelAsync -->
                    <div class="method">
                        <h3>LoadModelAsync</h3>
                        <pre><code class="language-csharp">public override async Task&lt;bool&gt; LoadModelAsync(
    TransformerModelInfo modelInfo, 
    TransformerTask taskType, 
    Dictionary&lt;string, object&gt;? modelConfig = null
)</code></pre>
                        <p>Loads and configures a Cohere model for the specified task.</p>
                        
                        <h4>Available Models</h4>
                        <ul>
                            <li><strong>command:</strong> Latest Command model for generation</li>
                            <li><strong>command-light:</strong> Faster, lightweight generation</li>
                            <li><strong>command-nightly:</strong> Latest experimental features</li>
                            <li><strong>embed-english-v3.0:</strong> English embeddings</li>
                            <li><strong>embed-multilingual-v3.0:</strong> Multilingual embeddings</li>
                        </ul>
                    </div>

                    <!-- GenerateTextAsync -->
                    <div class="method">
                        <h3>GenerateTextAsync</h3>
                        <pre><code class="language-csharp">public override async Task&lt;TransformerResult&lt;string&gt;&gt; GenerateTextAsync(
    string prompt, 
    TextGenerationParameters? parameters = null
)</code></pre>
                        <p>Generates text using Cohere's advanced language models with enterprise-grade quality.</p>
                    </div>

                    <!-- GetEmbeddingsAsync -->
                    <div class="method">
                        <h3>GetEmbeddingsAsync</h3>
                        <pre><code class="language-csharp">public override async Task&lt;TransformerResult&lt;List&lt;float[]&gt;&gt;&gt; GetEmbeddingsAsync(
    List&lt;string&gt; texts, 
    EmbeddingParameters? parameters = null
)</code></pre>
                        <p>Generates high-quality semantic embeddings for text similarity and search applications.</p>
                        
                        <h4>Embedding Parameters</h4>
                        <ul>
                            <li><code>InputType:</code> "search_document", "search_query", "classification", "clustering"</li>
                            <li><code>Truncate:</code> "NONE", "START", "END"</li>
                        </ul>
                    </div>

                    <!-- GetSupportedTasks -->
                    <div class="method">
                        <h3>GetSupportedTasks</h3>
                        <pre><code class="language-csharp">public override List&lt;TransformerTask&gt; GetSupportedTasks()</code></pre>
                        <p>Returns the list of tasks supported by Cohere models:</p>
                        <ul>
                            <li>TextGeneration</li>
                            <li>TextClassification</li>
                            <li>Summarization</li>
                            <li>FeatureExtraction (Embeddings)</li>
                            <li>SimilarityComparison</li>
                            <li>Conversational</li>
                        </ul>
                    </div>
                </section>

                <!-- Usage Examples -->
                <section class="section" id="examples">
                    <h2>?? Usage Examples</h2>

                    <!-- Basic Setup -->
                    <div class="example">
                        <h3>1. Basic Setup and Text Generation</h3>
                        <pre><code class="language-csharp">using Beep.Python.AI.Transformers;

// Initialize the pipeline
var coherePipeline = new CohereTransformerPipeline(runtimeManager, executeManager);

// Configure with API key
var config = new TransformerPipelineConfig();
await coherePipeline.InitializeAsync(config);

// Load Command model
var modelInfo = new TransformerModelInfo
{
    Name = "command",
    Source = TransformerModelSource.Cohere
};

var modelConfig = new Dictionary&lt;string, object&gt;
{
    ["api_key"] = "your-cohere-api-key"
};

await coherePipeline.LoadModelAsync(modelInfo, TransformerTask.TextGeneration, modelConfig);

// Generate text
var result = await coherePipeline.GenerateTextAsync(
    "Write a professional email about project update",
    new TextGenerationParameters 
    { 
        MaxLength = 300,
        Temperature = 0.7,
        TopP = 0.9
    });

if (result.Success)
{
    Console.WriteLine($"Generated Email:\n{result.Data}");
    Console.WriteLine($"Tokens used: {result.TokenUsage?.TotalTokens}");
}
</code></pre>
                    </div>

                    <!-- Embeddings Example -->
                    <div class="example">
                        <h3>2. Semantic Embeddings for Search</h3>
                        <pre><code class="language-csharp">// Load embedding model
var embeddingModel = new TransformerModelInfo
{
    Name = "embed-english-v3.0",
    Source = TransformerModelSource.Cohere
};

var embeddingConfig = new Dictionary&lt;string, object&gt;
{
    ["api_key"] = "your-cohere-api-key"
};

await coherePipeline.LoadModelAsync(embeddingModel, TransformerTask.FeatureExtraction, embeddingConfig);

// Generate embeddings for documents
var documents = new List&lt;string&gt;
{
    "Machine learning is a subset of artificial intelligence",
    "Deep learning uses neural networks with multiple layers",
    "Natural language processing handles human language",
    "Computer vision enables machines to interpret visual information"
};

var embeddings = await coherePipeline.GetEmbeddingsAsync(documents, 
    new EmbeddingParameters 
    { 
        InputType = "search_document",
        Truncate = "END"
    });

if (embeddings.Success)
{
    Console.WriteLine($"Generated {embeddings.Data.Count} embeddings");
    Console.WriteLine($"Embedding dimension: {embeddings.Data[0].Length}");
    
    // Use embeddings for similarity search
    var queryEmbedding = await coherePipeline.GetEmbeddingsAsync(
        new List&lt;string&gt; { "What is AI and machine learning?" }, 
        new EmbeddingParameters { InputType = "search_query" });
    
    // Calculate similarities (implementation not shown)
    var similarities = CalculateCosineSimilarity(queryEmbedding.Data[0], embeddings.Data);
}
</code></pre>
                    </div>

                    <!-- Enterprise Configuration -->
                    <div class="example">
                        <h3>3. Enterprise Configuration</h3>
                        <pre><code class="language-csharp">// Enterprise setup with custom endpoint
var enterpriseConfig = new Dictionary&lt;string, object&gt;
{
    ["api_key"] = Environment.GetEnvironmentVariable("COHERE_API_KEY"),
    ["base_url"] = "https://api.cohere.ai/v1", // Custom enterprise endpoint
    ["timeout"] = 60, // Extended timeout for large requests
    ["retry_attempts"] = 3
};

var modelInfo = new TransformerModelInfo
{
    Name = "command-nightly", // Latest experimental model
    Source = TransformerModelSource.Cohere
};

await coherePipeline.LoadModelAsync(modelInfo, TransformerTask.TextGeneration, enterpriseConfig);

// Generate with advanced parameters
var result = await coherePipeline.GenerateTextAsync(
    "Analyze the quarterly business performance and provide strategic recommendations",
    new TextGenerationParameters 
    { 
        MaxLength = 500,
        Temperature = 0.3, // Lower temperature for more focused output
        TopK = 40,
        StopSequences = new List&lt;string&gt; { "\n\n", "---" }
    });

// Monitor usage and performance
if (result.Success)
{
    Console.WriteLine($"Response time: {result.ExecutionTimeMs}ms");
    Console.WriteLine($"Model used: {result.Metadata?["model"]}");
    Console.WriteLine($"Finish reason: {result.Metadata?["finish_reason"]}");
}
</code></pre>
                    </div>

                    <!-- Classification Example -->
                    <div class="example">
                        <h3>4. Text Classification</h3>
                        <pre><code class="language-csharp">// Setup for classification task
var classificationPrompt = @"
Classify the following text into one of these categories: positive, negative, neutral.

Text: ""The new product launch exceeded all expectations and customers are thrilled!""

Classification:";

var result = await coherePipeline.GenerateTextAsync(classificationPrompt,
    new TextGenerationParameters 
    { 
        MaxLength = 10,
        Temperature = 0.1 // Low temperature for consistent classification
    });

if (result.Success)
{
    var classification = result.Data.Trim().ToLower();
    Console.WriteLine($"Classification: {classification}");
}

// Batch classification
var textsToClassify = new[]
{
    "This service is amazing and I highly recommend it!",
    "The product broke after just one week of use.",
    "It's an okay product, nothing special but does the job."
};

foreach (var text in textsToClassify)
{
    var prompt = $"Classify as positive/negative/neutral: \"{text}\"\nClassification:";
    var classResult = await coherePipeline.GenerateTextAsync(prompt, 
        new TextGenerationParameters { MaxLength = 10, Temperature = 0.1 });
    
    if (classResult.Success)
    {
        Console.WriteLine($"Text: {text}");
        Console.WriteLine($"Classification: {classResult.Data.Trim()}");
    }
}
</code></pre>
                    </div>
                </section>

                <!-- Advanced Features -->
                <section class="section" id="advanced">
                    <h2>?? Advanced Features</h2>

                    <!-- Streaming Responses -->
                    <div class="feature-section">
                        <h3>Streaming Responses</h3>
                        <p>For real-time applications, Cohere supports streaming responses:</p>
                        <pre><code class="language-csharp">// Note: Streaming support would be implemented in future versions
// This shows the intended API design

var streamingConfig = new Dictionary&lt;string, object&gt;
{
    ["api_key"] = "your-api-key",
    ["stream"] = true
};

// This would stream responses as they're generated
await foreach (var chunk in coherePipeline.GenerateTextStreamAsync(prompt, parameters))
{
    Console.Write(chunk.Data);
}
</code></pre>
                    </div>

                    <!-- Safety and Content Moderation -->
                    <div class="feature-section">
                        <h3>Content Safety</h3>
                        <p>Cohere provides built-in content safety and moderation:</p>
                        <pre><code class="language-csharp">// Safety settings can be configured
var safetyConfig = new Dictionary&lt;string, object&gt;
{
    ["api_key"] = "your-api-key",
    ["safety_mode"] = "CONTEXTUAL", // STRICT, CONTEXTUAL, NONE
    ["content_filter"] = true
};

await coherePipeline.LoadModelAsync(modelInfo, TransformerTask.TextGeneration, safetyConfig);

// The model will automatically filter harmful content
var result = await coherePipeline.GenerateTextAsync(
    "Write content about workplace safety practices");

// Check safety metadata
if (result.Metadata?.ContainsKey("safety_ratings") == true)
{
    Console.WriteLine($"Content safety: {result.Metadata["safety_ratings"]}");
}
</code></pre>
                    </div>

                    <!-- Performance Optimization -->
                    <div class="feature-section">
                        <h3>Performance Optimization</h3>
                        <p>Tips for optimizing Cohere API usage:</p>
                        <div class="tip">
                            <ul>
                                <li><strong>Batch Requests:</strong> Process multiple texts in single API calls</li>
                                <li><strong>Model Selection:</strong> Use 'command-light' for faster responses</li>
                                <li><strong>Caching:</strong> Cache embeddings for frequently used texts</li>
                                <li><strong>Truncation:</strong> Use appropriate truncation for embeddings</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- Error Handling -->
                <section class="section" id="error-handling">
                    <h2>??? Error Handling</h2>

                    <div class="code-example">
                        <h4>Robust Error Handling Pattern</h4>
                        <pre><code class="language-csharp">try
{
    var result = await coherePipeline.GenerateTextAsync(prompt, parameters);
    
    if (!result.Success)
    {
        // Handle API errors
        switch (result.ErrorMessage)
        {
            case string msg when msg.Contains("rate limit"):
                Console.WriteLine("Rate limit exceeded. Waiting before retry...");
                await Task.Delay(TimeSpan.FromSeconds(60));
                // Implement retry logic
                break;
                
            case string msg when msg.Contains("invalid api key"):
                Console.WriteLine("Invalid API key. Please check your credentials.");
                break;
                
            case string msg when msg.Contains("quota exceeded"):
                Console.WriteLine("API quota exceeded. Please upgrade your plan.");
                break;
                
            default:
                Console.WriteLine($"API error: {result.ErrorMessage}");
                break;
        }
    }
    else
    {
        // Success - process result
        Console.WriteLine($"Generated text: {result.Data}");
    }
}
catch (ArgumentException ex)
{
    Console.WriteLine($"Configuration error: {ex.Message}");
}
catch (InvalidOperationException ex)
{
    Console.WriteLine($"Pipeline error: {ex.Message}");
}
catch (Exception ex)
{
    Console.WriteLine($"Unexpected error: {ex.Message}");
    // Log for debugging
}</code></pre>
                    </div>
                </section>

                <!-- Best Practices -->
                <section class="section" id="best-practices">
                    <h2>? Best Practices</h2>

                    <div class="tip">
                        <h4>?? Security</h4>
                        <ul>
                            <li><strong>API Key Management:</strong> Store keys in environment variables or secure vaults</li>
                            <li><strong>Request Validation:</strong> Validate input before sending to API</li>
                            <li><strong>Rate Limiting:</strong> Implement client-side rate limiting</li>
                            <li><strong>Logging:</strong> Log API usage for monitoring and debugging</li>
                        </ul>
                    </div>

                    <div class="warning">
                        <h4>?? Cost Optimization</h4>
                        <ul>
                            <li><strong>Token Management:</strong> Monitor token usage to control costs</li>
                            <li><strong>Model Selection:</strong> Use appropriate model size for your use case</li>
                            <li><strong>Caching:</strong> Cache results for repeated requests</li>
                            <li><strong>Batch Processing:</strong> Group multiple requests when possible</li>
                        </ul>
                    </div>

                    <div class="note">
                        <h4>??? Architecture</h4>
                        <ul>
                            <li><strong>Async Operations:</strong> Always use async/await for API calls</li>
                            <li><strong>Circuit Breaker:</strong> Implement circuit breaker pattern for resilience</li>
                            <li><strong>Retry Logic:</strong> Add exponential backoff for transient failures</li>
                            <li><strong>Monitoring:</strong> Track API performance and error rates</li>
                        </ul>
                    </div>
                </section>

                <!-- Navigation Links -->
                <div class="nav-links">
                    <a href="AnthropicTransformerPipeline.html" class="btn-beep">
                        <i class="bi bi-arrow-left"></i> AnthropicTransformerPipeline
                    </a>
                    <a href="MetaTransformerPipeline.html" class="btn-beep">
                        <i class="bi bi-arrow-right"></i> MetaTransformerPipeline
                    </a>
                </div>

                <!-- Footer -->
                <footer class="documentation-footer">
                    <div class="footer-content">
                        <div class="footer-copyright">
                            <p>&copy; 2024 The Tech Idea - Beep.Python.AI.Transformers API Documentation</p>
                        </div>
                        <div class="footer-links">
                            <a href="../index.html">Home</a>
                            <a href="ITransformerPipeLine.html">ITransformerPipeLine</a>
                            <a href="TransformerPipelineFactory.html">Pipeline Factory</a>
                        </div>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="../assets/navigation.js"></script>
</body>
</html>