<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Intelligence Examples - Beep.Python.DataManagement</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <link href="../assets/styles.css" rel="stylesheet">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="bi bi-sun-fill" id="theme-icon"></i>
    </button>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Navigation will be loaded dynamically by navigation.js -->
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb Navigation -->
                <div class="breadcrumb-nav">
                    <a href="../index.html">Home</a>
                    <span>?</span>
                    <a href="../index.html#examples">Examples</a>
                    <span>?</span>
                    <span>Business Intelligence</span>
                </div>

                <!-- Page Header -->
                <div class="page-header">
                    <h1><i class="bi bi-graph-up"></i> Business Intelligence Examples</h1>
                    <p class="page-subtitle">Real-world BI scenarios using pandas DataFrame operations for executive dashboards, KPI tracking, and business analytics</p>
                </div>

                <!-- Overview -->
                <section class="section" id="overview">
                    <h2>?? BI Use Cases Covered</h2>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4><i class="bi bi-speedometer2"></i> Executive Dashboard</h4>
                            <p>Key metrics, trends, and performance indicators for C-level reporting</p>
                            <a href="#executive-dashboard" class="btn btn-outline-primary btn-sm">View Example</a>
                        </div>
                        
                        <div class="feature-card">
                            <h4><i class="bi bi-people"></i> Customer Analytics</h4>
                            <p>Customer segmentation, lifetime value, and behavioral analysis</p>
                            <a href="#customer-analytics" class="btn btn-outline-primary btn-sm">View Example</a>
                        </div>
                        
                        <div class="feature-card">
                            <h4><i class="bi bi-cart"></i> Sales Performance</h4>
                            <p>Territory analysis, sales forecasting, and commission tracking</p>
                            <a href="#sales-performance" class="btn btn-outline-primary btn-sm">View Example</a>
                        </div>
                        
                        <div class="feature-card">
                            <h4><i class="bi bi-cash-stack"></i> Financial Analysis</h4>
                            <p>Revenue trending, profitability analysis, and budget variance</p>
                            <a href="#financial-analysis" class="btn btn-outline-primary btn-sm">View Example</a>
                        </div>
                    </div>
                </section>

                <!-- Executive Dashboard -->
                <section class="section" id="executive-dashboard">
                    <h2>?? Executive Dashboard Implementation</h2>
                    
                    <div class="code-example">
                        <h4>1. Data Loading and Preparation</h4>
                        <pre><code class="language-csharp">public class ExecutiveDashboardService
{
    private readonly IPythonPandasManager _pandasManager;
    
    public ExecutiveDashboardService(IPythonPandasManager pandasManager)
    {
        _pandasManager = pandasManager;
    }
    
    public async Task&lt;ExecutiveDashboardData&gt; GenerateDashboard(string userId, DateTime fromDate, DateTime toDate)
    {
        // Configure session for user
        _pandasManager.ConfigureSessionForUser(userId, "executive-analytics");
        
        try
        {
            // Load core business data
            await LoadCoreBusinessData(fromDate, toDate);
            
            // Generate executive metrics
            var dashboard = new ExecutiveDashboardData
            {
                RevenueMetrics = await CalculateRevenueMetrics(),
                CustomerMetrics = await CalculateCustomerMetrics(),
                OperationalMetrics = await CalculateOperationalMetrics(),
                TrendAnalysis = await GenerateTrendAnalysis(),
                RegionalPerformance = await AnalyzeRegionalPerformance()
            };
            
            return dashboard;
        }
        finally
        {
            _pandasManager.CleanupIdleDataFrames();
        }
    }
    
    private async Task LoadCoreBusinessData(DateTime fromDate, DateTime toDate)
    {
        // Load sales data
        string salesQuery = $@"
            SELECT s.*, c.CustomerType, c.Region, p.Category, p.CostPrice
            FROM Sales s
            JOIN Customers c ON s.CustomerID = c.CustomerID  
            JOIN Products p ON s.ProductID = p.ProductID
            WHERE s.SaleDate BETWEEN '{fromDate:yyyy-MM-dd}' AND '{toDate:yyyy-MM-dd}'
        ";
        
        _pandasManager.ReadSql("sales_data", salesQuery, connectionString);
        
        // Load customer data
        _pandasManager.ReadSql("customers", "SELECT * FROM Customers WHERE IsActive = 1", connectionString);
        
        // Load financial data
        string financialQuery = $@"
            SELECT * FROM FinancialMetrics 
            WHERE MetricDate BETWEEN '{fromDate:yyyy-MM-dd}' AND '{toDate:yyyy-MM-dd}'
        ";
        
        _pandasManager.ReadSql("financial_data", financialQuery, connectionString);
    }
}</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>2. Revenue Metrics Calculation</h4>
                        <pre><code class="language-csharp">private async Task&lt;RevenueMetrics&gt; CalculateRevenueMetrics()
{
    // Calculate total revenue
    string totalRevenue = _pandasManager.CalculateMean("sales_data", "Amount");
    
    // Add profit calculations
    _pandasManager.AddColumn("sales_data", "Profit", "Amount - (Quantity * CostPrice)");
    _pandasManager.AddColumn("sales_data", "ProfitMargin", "(Profit / Amount) * 100");
    
    // Group by time periods
    _pandasManager.AddColumn("sales_data", "SaleMonth", "pd.to_datetime(SaleDate).dt.to_period('M')");
    _pandasManager.GroupBy("sales_data", "monthly_revenue", "SaleMonth", "sum");
    
    // Calculate growth rates
    string growthCalculation = @"
        monthly_revenue_sorted = monthly_revenue.sort_index()
        monthly_revenue_sorted['Revenue_Growth'] = monthly_revenue_sorted['Amount'].pct_change() * 100
        monthly_revenue_sorted['Profit_Growth'] = monthly_revenue_sorted['Profit'].pct_change() * 100
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(growthCalculation);
    
    // Get current vs previous period
    string currentVsPrevious = @"
        current_month = monthly_revenue_sorted.iloc[-1]
        previous_month = monthly_revenue_sorted.iloc[-2] if len(monthly_revenue_sorted) > 1 else None
        
        revenue_change = current_month['Revenue_Growth'] if previous_month is not None else 0
        profit_change = current_month['Profit_Growth'] if previous_month is not None else 0
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(currentVsPrevious);
    
    return new RevenueMetrics
    {
        TotalRevenue = decimal.Parse(totalRevenue),
        TotalProfit = decimal.Parse(_pandasManager.CalculateMean("sales_data", "Profit")),
        RevenueGrowth = GetPythonVariable("revenue_change"),
        ProfitGrowth = GetPythonVariable("profit_change"),
        MonthlyTrend = _pandasManager.GetDataFrameAsJson("monthly_revenue")
    };
}</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>3. Customer Metrics and Segmentation</h4>
                        <pre><code class="language-csharp">private async Task&lt;CustomerMetrics&gt; CalculateCustomerMetrics()
{
    // Customer segmentation analysis
    string segmentationCode = @"
        # Calculate customer lifetime value
        customer_summary = sales_data.groupby('CustomerID').agg({
            'Amount': ['sum', 'count', 'mean'],
            'SaleDate': ['min', 'max']
        }).round(2)
        
        customer_summary.columns = ['TotalSpent', 'OrderCount', 'AvgOrderValue', 'FirstOrder', 'LastOrder']
        customer_summary = customer_summary.reset_index()
        
        # Calculate recency, frequency, monetary (RFM) scores
        from datetime import datetime
        current_date = datetime.now()
        
        customer_summary['Recency'] = (current_date - pd.to_datetime(customer_summary['LastOrder'])).dt.days
        customer_summary['Frequency'] = customer_summary['OrderCount']  
        customer_summary['Monetary'] = customer_summary['TotalSpent']
        
        # Create RFM quintiles
        customer_summary['R_Score'] = pd.qcut(customer_summary['Recency'].rank(method='first'), 5, labels=[5,4,3,2,1])
        customer_summary['F_Score'] = pd.qcut(customer_summary['Frequency'].rank(method='first'), 5, labels=[1,2,3,4,5])
        customer_summary['M_Score'] = pd.qcut(customer_summary['Monetary'].rank(method='first'), 5, labels=[1,2,3,4,5])
        
        # Combine RFM scores
        customer_summary['RFM_Score'] = customer_summary['R_Score'].astype(str) + customer_summary['F_Score'].astype(str) + customer_summary['M_Score'].astype(str)
        
        # Segment customers
        def segment_customers(rfm):
            if rfm in ['555', '554', '544', '545', '454', '455', '445']:
                return 'Champions'
            elif rfm in ['543', '444', '435', '355', '354', '345', '344', '335']:
                return 'Loyal Customers'
            elif rfm in ['512', '511', '422', '421', '412', '411', '311']:
                return 'New Customers'
            elif rfm in ['533', '532', '531', '523', '522', '521', '515', '514', '513', '425', '424', '413', '414', '415', '315', '314', '313']:
                return 'Potential Loyalists'
            elif rfm in ['155', '154', '144', '214', '215', '115', '114']:
                return 'At Risk'
            elif rfm in ['155', '254', '144']:
                return 'Cannot Lose Them'
            else:
                return 'Others'
        
        customer_summary['Segment'] = customer_summary['RFM_Score'].apply(segment_customers)
        
        # Calculate segment statistics
        segment_stats = customer_summary.groupby('Segment').agg({
            'CustomerID': 'count',
            'TotalSpent': 'sum',
            'AvgOrderValue': 'mean',
            'Frequency': 'mean'
        }).round(2)
        
        segment_stats.columns = ['CustomerCount', 'TotalRevenue', 'AvgOrderValue', 'AvgFrequency']
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(segmentationCode);
    
    // Get new vs returning customer metrics
    _pandasManager.GroupBy("customer_summary", "customer_types", "Segment", "count");
    
    return new CustomerMetrics
    {
        TotalCustomers = int.Parse(_pandasManager.UniqueValues("sales_data", "CustomerID")),
        NewCustomers = GetNewCustomerCount(),
        CustomerSegmentation = _pandasManager.GetDataFrameAsJson("segment_stats"),
        ChurnRisk = CalculateChurnRisk(),
        CustomerLifetimeValue = decimal.Parse(_pandasManager.CalculateMean("customer_summary", "TotalSpent"))
    };
}</code></pre>
                    </div>
                </section>

                <!-- Sales Performance Analytics -->
                <section class="section" id="sales-performance">
                    <h2>?? Sales Performance Analytics</h2>
                    
                    <div class="code-example">
                        <h4>1. Territory and Sales Rep Analysis</h4>
                        <pre><code class="language-csharp">public async Task&lt;SalesPerformanceReport&gt; GenerateSalesPerformance(string period)
{
    // Territory performance analysis
    string territoryAnalysis = @"
        # Sales by territory
        territory_performance = sales_data.groupby(['Region', 'SalesRep']).agg({
            'Amount': ['sum', 'count', 'mean'],
            'Profit': 'sum',
            'CustomerID': 'nunique'
        }).round(2)
        
        territory_performance.columns = ['TotalSales', 'OrderCount', 'AvgOrderValue', 'TotalProfit', 'UniqueCustomers']
        territory_performance = territory_performance.reset_index()
        
        # Calculate performance metrics
        territory_performance['SalesPerCustomer'] = territory_performance['TotalSales'] / territory_performance['UniqueCustomers']
        territory_performance['ProfitMargin'] = (territory_performance['TotalProfit'] / territory_performance['TotalSales']) * 100
        
        # Rank territories
        territory_performance['SalesRank'] = territory_performance['TotalSales'].rank(method='dense', ascending=False)
        territory_performance['ProfitRank'] = territory_performance['TotalProfit'].rank(method='dense', ascending=False)
        
        # Territory comparison
        territory_summary = territory_performance.groupby('Region').agg({
            'TotalSales': 'sum',
            'TotalProfit': 'sum',
            'UniqueCustomers': 'sum',
            'SalesRep': 'count'
        }).round(2)
        
        territory_summary.columns = ['TotalSales', 'TotalProfit', 'TotalCustomers', 'SalesRepCount']
        territory_summary['AvgSalesPerRep'] = territory_summary['TotalSales'] / territory_summary['SalesRepCount']
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(territoryAnalysis);
    
    // Product performance analysis
    string productAnalysis = @"
        # Product performance
        product_performance = sales_data.groupby(['Category', 'ProductName']).agg({
            'Amount': 'sum',
            'Quantity': 'sum',
            'Profit': 'sum'
        }).round(2)
        
        # ABC Analysis (Pareto principle)
        product_totals = product_performance.groupby('Category')['Amount'].sum().sort_values(ascending=False)
        cumsum = product_totals.cumsum()
        total_sales = product_totals.sum()
        
        # Categorize products
        abc_categories = []
        for cum_val in cumsum:
            pct = (cum_val / total_sales) * 100
            if pct <= 80:
                abc_categories.append('A')
            elif pct <= 95:
                abc_categories.append('B')
            else:
                abc_categories.append('C')
        
        product_abc = pd.DataFrame({
            'Category': product_totals.index,
            'Sales': product_totals.values,
            'ABC_Class': abc_categories
        })
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(productAnalysis);
    
    return new SalesPerformanceReport
    {
        TerritoryPerformance = _pandasManager.GetDataFrameAsJson("territory_performance"),
        RegionalSummary = _pandasManager.GetDataFrameAsJson("territory_summary"),
        ProductPerformance = _pandasManager.GetDataFrameAsJson("product_abc"),
        TopPerformers = GetTopPerformers(),
        SalesTargetAnalysis = CalculateSalesTargets()
    };
}</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>2. Sales Forecasting</h4>
                        <pre><code class="language-csharp">private async Task&lt;ForecastData&gt; GenerateSalesForecast(int forecastMonths = 6)
{
    string forecastingCode = $@"
        import numpy as np
        from datetime import datetime, timedelta
        
        # Prepare time series data
        sales_data['SaleDate'] = pd.to_datetime(sales_data['SaleDate'])
        daily_sales = sales_data.groupby('SaleDate')['Amount'].sum().reset_index()
        daily_sales = daily_sales.sort_values('SaleDate')
        
        # Handle missing dates
        date_range = pd.date_range(start=daily_sales['SaleDate'].min(), 
                                  end=daily_sales['SaleDate'].max(), 
                                  freq='D')
        daily_sales = daily_sales.set_index('SaleDate').reindex(date_range, fill_value=0).reset_index()
        daily_sales.columns = ['SaleDate', 'Amount']
        
        # Simple moving average forecast
        window = 30  # 30-day moving average
        daily_sales['MA_30'] = daily_sales['Amount'].rolling(window=window).mean()
        
        # Exponential smoothing
        alpha = 0.3
        daily_sales['EMA'] = daily_sales['Amount'].ewm(alpha=alpha).mean()
        
        # Linear trend
        from scipy import stats
        x = np.arange(len(daily_sales))
        slope, intercept, r_value, p_value, std_err = stats.linregress(x, daily_sales['Amount'])
        
        # Generate forecast
        last_date = daily_sales['SaleDate'].max()
        forecast_dates = pd.date_range(start=last_date + timedelta(days=1), 
                                      periods={forecastMonths * 30}, 
                                      freq='D')
        
        forecast_x = np.arange(len(daily_sales), len(daily_sales) + len(forecast_dates))
        forecast_linear = slope * forecast_x + intercept
        
        # Add seasonality adjustment (simple weekly pattern)
        weekly_pattern = daily_sales.groupby(daily_sales['SaleDate'].dt.dayofweek)['Amount'].mean()
        forecast_seasonal = []
        
        for i, date in enumerate(forecast_dates):
            base_forecast = forecast_linear[i]
            seasonal_factor = weekly_pattern[date.dayofweek] / weekly_pattern.mean()
            seasonal_forecast = base_forecast * seasonal_factor
            forecast_seasonal.append(max(0, seasonal_forecast))  # Ensure non-negative
        
        forecast_df = pd.DataFrame({{
            'Date': forecast_dates,
            'Forecast_Linear': forecast_linear,
            'Forecast_Seasonal': forecast_seasonal,
            'Confidence_Upper': np.array(forecast_seasonal) * 1.2,
            'Confidence_Lower': np.array(forecast_seasonal) * 0.8
        }})
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(forecastingCode);
    
    return new ForecastData
    {
        HistoricalTrend = _pandasManager.GetDataFrameAsJson("daily_sales"),
        ForecastData = _pandasManager.GetDataFrameAsJson("forecast_df"),
        TrendAnalysis = new TrendAnalysis
        {
            Slope = GetPythonVariable("slope"),
            RSquared = GetPythonVariable("r_value"),
            SeasonalityDetected = true
        }
    };
}</code></pre>
                    </div>
                </section>

                <!-- Financial Analysis -->
                <section class="section" id="financial-analysis">
                    <h2>?? Financial Analysis and Reporting</h2>
                    
                    <div class="code-example">
                        <h4>1. Profitability Analysis</h4>
                        <pre><code class="language-csharp">public async Task&lt;FinancialAnalysisReport&gt; GenerateFinancialAnalysis(string fiscalYear)
{
    string profitabilityCode = @"
        # Profitability by product category
        profitability = sales_data.groupby('Category').agg({
            'Amount': 'sum',
            'Profit': 'sum',
            'Quantity': 'sum'
        }).round(2)
        
        profitability['ProfitMargin'] = (profitability['Profit'] / profitability['Amount']) * 100
        profitability['AvgSalePrice'] = profitability['Amount'] / profitability['Quantity']
        profitability['ProfitPerUnit'] = profitability['Profit'] / profitability['Quantity']
        
        # Rank by profitability
        profitability['ProfitRank'] = profitability['Profit'].rank(method='dense', ascending=False)
        profitability['MarginRank'] = profitability['ProfitMargin'].rank(method='dense', ascending=False)
        
        # Customer profitability
        customer_profit = sales_data.groupby('CustomerID').agg({
            'Amount': 'sum',
            'Profit': 'sum',
            'SaleDate': 'count'
        }).round(2)
        
        customer_profit.columns = ['TotalRevenue', 'TotalProfit', 'OrderCount']
        customer_profit['ProfitPerOrder'] = customer_profit['TotalProfit'] / customer_profit['OrderCount']
        customer_profit['RevenuePerOrder'] = customer_profit['TotalRevenue'] / customer_profit['OrderCount']
        
        # 80/20 analysis
        customer_profit_sorted = customer_profit.sort_values('TotalProfit', ascending=False)
        customer_profit_sorted['CumulativeProfit'] = customer_profit_sorted['TotalProfit'].cumsum()
        total_profit = customer_profit_sorted['TotalProfit'].sum()
        customer_profit_sorted['CumulativePct'] = (customer_profit_sorted['CumulativeProfit'] / total_profit) * 100
        
        # Identify top 20% customers contributing 80% profit
        top_20_pct_count = int(len(customer_profit_sorted) * 0.2)
        pareto_customers = customer_profit_sorted.head(top_20_pct_count)
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(profitabilityCode);
    
    // Cost structure analysis
    string costAnalysis = @"
        # Cost breakdown analysis
        cost_structure = sales_data.copy()
        cost_structure['COGS'] = cost_structure['Quantity'] * cost_structure['CostPrice']
        cost_structure['GrossProfit'] = cost_structure['Amount'] - cost_structure['COGS']
        cost_structure['GrossMargin'] = (cost_structure['GrossProfit'] / cost_structure['Amount']) * 100
        
        # Monthly cost trends
        cost_structure['SaleMonth'] = pd.to_datetime(cost_structure['SaleDate']).dt.to_period('M')
        monthly_costs = cost_structure.groupby('SaleMonth').agg({
            'Amount': 'sum',
            'COGS': 'sum', 
            'GrossProfit': 'sum'
        }).round(2)
        
        monthly_costs['GrossMargin'] = (monthly_costs['GrossProfit'] / monthly_costs['Amount']) * 100
        monthly_costs['COGSPercentage'] = (monthly_costs['COGS'] / monthly_costs['Amount']) * 100
        
        # Budget variance analysis (assuming budget data exists)
        # This would typically come from a separate budget table
        monthly_costs['BudgetRevenue'] = monthly_costs['Amount'] * 1.1  # Placeholder
        monthly_costs['RevenueVariance'] = monthly_costs['Amount'] - monthly_costs['BudgetRevenue']
        monthly_costs['VariancePercentage'] = (monthly_costs['RevenueVariance'] / monthly_costs['BudgetRevenue']) * 100
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(costAnalysis);
    
    return new FinancialAnalysisReport
    {
        ProfitabilityByCategory = _pandasManager.GetDataFrameAsJson("profitability"),
        CustomerProfitability = _pandasManager.GetDataFrameAsJson("pareto_customers"),
        MonthlyCostTrends = _pandasManager.GetDataFrameAsJson("monthly_costs"),
        KeyFinancialMetrics = CalculateKPIs()
    };
}</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>2. Cash Flow and Working Capital Analysis</h4>
                        <pre><code class="language-csharp">private async Task&lt;CashFlowAnalysis&gt; AnalyzeCashFlow()
{
    string cashFlowCode = @"
        # Cash flow analysis
        # Assuming we have payment terms and collection data
        sales_data['PaymentTerms'] = sales_data.get('PaymentTerms', 30)  # Default 30 days
        sales_data['SaleDate'] = pd.to_datetime(sales_data['SaleDate'])
        sales_data['ExpectedPaymentDate'] = sales_data['SaleDate'] + pd.to_timedelta(sales_data['PaymentTerms'], unit='D')
        
        # Outstanding receivables
        current_date = pd.Timestamp.now()
        sales_data['DaysOutstanding'] = (current_date - sales_data['SaleDate']).dt.days
        sales_data['IsOverdue'] = sales_data['DaysOutstanding'] > sales_data['PaymentTerms']
        
        # Aging analysis
        def age_bucket(days):
            if days <= 30:
                return '0-30 days'
            elif days <= 60:
                return '31-60 days'
            elif days <= 90:
                return '61-90 days'
            else:
                return '90+ days'
        
        sales_data['AgeBucket'] = sales_data['DaysOutstanding'].apply(age_bucket)
        
        aging_analysis = sales_data.groupby('AgeBucket').agg({
            'Amount': ['sum', 'count'],
            'CustomerID': 'nunique'
        }).round(2)
        
        aging_analysis.columns = ['TotalAmount', 'InvoiceCount', 'CustomerCount']
        
        # Cash flow projection
        payment_projection = sales_data[sales_data['ExpectedPaymentDate'] >= current_date].copy()
        payment_projection['PaymentMonth'] = payment_projection['ExpectedPaymentDate'].dt.to_period('M')
        
        monthly_cash_flow = payment_projection.groupby('PaymentMonth')['Amount'].sum().reset_index()
        monthly_cash_flow['CumulativeCashFlow'] = monthly_cash_flow['Amount'].cumsum()
        
        # Working capital metrics
        total_receivables = sales_data['Amount'].sum()
        overdue_amount = sales_data[sales_data['IsOverdue']]['Amount'].sum()
        overdue_percentage = (overdue_amount / total_receivables) * 100
        
        avg_collection_days = sales_data['DaysOutstanding'].mean()
    ";
    
    await _pandasManager.ExecutePythonCodeAsync(cashFlowCode);
    
    return new CashFlowAnalysis
    {
        AgingAnalysis = _pandasManager.GetDataFrameAsJson("aging_analysis"),
        CashFlowProjection = _pandasManager.GetDataFrameAsJson("monthly_cash_flow"),
        OverduePercentage = GetPythonVariable("overdue_percentage"),
        AverageCollectionDays = GetPythonVariable("avg_collection_days"),
        TotalReceivables = GetPythonVariable("total_receivables")
    };
}</code></pre>
                    </div>
                </section>

                <!-- Real-time Dashboard Integration -->
                <section class="section" id="dashboard-integration">
                    <h2>?? Real-time Dashboard Integration</h2>
                    
                    <div class="code-example">
                        <h4>Web API Integration for Live Dashboards</h4>
                        <pre><code class="language-csharp">[ApiController]
[Route("api/[controller]")]
public class BusinessIntelligenceController : ControllerBase
{
    private readonly IPythonPandasManager _pandasManager;
    private readonly ICacheService _cache;
    
    public BusinessIntelligenceController(IPythonPandasManager pandasManager, ICacheService cache)
    {
        _pandasManager = pandasManager;
        _cache = cache;
    }

    [HttpGet("executive-summary")]
    public async Task&lt;IActionResult&gt; GetExecutiveSummary([FromQuery] string period = "current_month")
    {
        string cacheKey = $"executive_summary_{period}_{DateTime.Now:yyyyMMdd}";
        
        var cachedData = await _cache.GetAsync&lt;object&gt;(cacheKey);
        if (cachedData != null)
        {
            return Ok(cachedData);
        }

        var userId = User.Identity.Name;
        _pandasManager.ConfigureSessionForUser(userId, "executive-bi");

        try
        {
            var dashboardService = new ExecutiveDashboardService(_pandasManager);
            var summary = await dashboardService.GenerateExecutiveSummary(period);
            
            // Cache for 1 hour
            await _cache.SetAsync(cacheKey, summary, TimeSpan.FromHours(1));
            
            return Ok(summary);
        }
        catch (Exception ex)
        {
            return StatusCode(500, new { error = ex.Message });
        }
    }

    [HttpGet("kpi-metrics")]
    public async Task&lt;IActionResult&gt; GetKPIMetrics()
    {
        var userId = User.Identity.Name;
        _pandasManager.ConfigureSessionForUser(userId, "kpi-analytics");

        // Real-time KPI calculation
        string kpiCode = @"
            from datetime import datetime, timedelta
            
            # Current month metrics
            current_month_start = datetime.now().replace(day=1)
            last_month_start = (current_month_start - timedelta(days=1)).replace(day=1)
            
            current_month_data = sales_data[
                pd.to_datetime(sales_data['SaleDate']) >= pd.Timestamp(current_month_start)
            ]
            
            last_month_data = sales_data[
                (pd.to_datetime(sales_data['SaleDate']) >= pd.Timestamp(last_month_start)) &
                (pd.to_datetime(sales_data['SaleDate']) < pd.Timestamp(current_month_start))
            ]
            
            kpis = {
                'current_month_revenue': current_month_data['Amount'].sum(),
                'last_month_revenue': last_month_data['Amount'].sum(),
                'current_month_orders': len(current_month_data),
                'last_month_orders': len(last_month_data),
                'current_month_customers': current_month_data['CustomerID'].nunique(),
                'avg_order_value': current_month_data['Amount'].mean(),
                'conversion_rate': (current_month_data['CustomerID'].nunique() / 
                                   current_month_data['SaleDate'].nunique()) * 100
            }
            
            # Calculate growth rates
            kpis['revenue_growth'] = ((kpis['current_month_revenue'] - kpis['last_month_revenue']) / 
                                     kpis['last_month_revenue']) * 100 if kpis['last_month_revenue'] > 0 else 0
            
            kpis['order_growth'] = ((kpis['current_month_orders'] - kpis['last_month_orders']) / 
                                   kpis['last_month_orders']) * 100 if kpis['last_month_orders'] > 0 else 0
        ";

        await _pandasManager.ExecutePythonCodeAsync(kpiCode);
        
        var kpis = GetPythonDictionary("kpis");
        return Ok(kpis);
    }

    [HttpGet("trend-data/{metric}")]
    public async Task&lt;IActionResult&gt; GetTrendData(string metric, [FromQuery] int days = 30)
    {
        var userId = User.Identity.Name;
        _pandasManager.ConfigureSessionForUser(userId);

        string trendCode = $@"
            from datetime import datetime, timedelta
            
            end_date = datetime.now()
            start_date = end_date - timedelta(days={days})
            
            trend_data = sales_data[
                pd.to_datetime(sales_data['SaleDate']) >= pd.Timestamp(start_date)
            ].copy()
            
            trend_data['Date'] = pd.to_datetime(trend_data['SaleDate']).dt.date
            
            if '{metric}' == 'revenue':
                daily_trends = trend_data.groupby('Date')['Amount'].sum().reset_index()
            elif '{metric}' == 'orders':
                daily_trends = trend_data.groupby('Date').size().reset_index(name='Count')
            elif '{metric}' == 'customers':
                daily_trends = trend_data.groupby('Date')['CustomerID'].nunique().reset_index()
            
            daily_trends['Date'] = daily_trends['Date'].astype(str)
        ";

        await _pandasManager.ExecutePythonCodeAsync(trendCode);
        
        string trendJson = _pandasManager.GetDataFrameAsJson("daily_trends");
        return Ok(JsonSerializer.Deserialize&lt;object&gt;(trendJson));
    }
}</code></pre>
                    </div>
                </section>

                <!-- Best Practices -->
                <section class="section" id="best-practices">
                    <h2>? BI Implementation Best Practices</h2>
                    
                    <div class="tip">
                        <h4>?? Performance Optimization</h4>
                        <ul>
                            <li><strong>Cache Results:</strong> Cache frequently accessed dashboard data for 15-60 minutes</li>
                            <li><strong>Incremental Loading:</strong> Load only new/changed data when possible</li>
                            <li><strong>Pre-aggregation:</strong> Pre-calculate common metrics during off-peak hours</li>
                            <li><strong>Session Management:</strong> Use dedicated analytics environments for BI workloads</li>
                        </ul>
                    </div>

                    <div class="tip">
                        <h4>?? Data Quality</h4>
                        <ul>
                            <li><strong>Data Validation:</strong> Implement checks for data completeness and accuracy</li>
                            <li><strong>Outlier Detection:</strong> Identify and handle anomalous data points</li>
                            <li><strong>Consistency Checks:</strong> Ensure metrics align across different reports</li>
                            <li><strong>Audit Trail:</strong> Track data lineage and transformation history</li>
                        </ul>
                    </div>

                    <div class="warning">
                        <h4>?? Security Considerations</h4>
                        <ul>
                            <li><strong>User-based Filtering:</strong> Ensure users only see authorized data</li>
                            <li><strong>Role-based Access:</strong> Implement different dashboard views by user role</li>
                            <li><strong>Data Masking:</strong> Hide sensitive information in shared reports</li>
                            <li><strong>Audit Logging:</strong> Log all dashboard access and data queries</li>
                        </ul>
                    </div>
                </section>

                <!-- Navigation Links -->
                <div class="nav-links">
                    <a href="basic-usage.html" class="btn-beep">
                        <i class="bi bi-arrow-left"></i> Basic Usage
                    </a>
                    <a href="etl-workflows.html" class="btn-beep">
                        <i class="bi bi-arrow-right"></i> ETL Workflows
                    </a>
                </div>

                <!-- Footer -->
                <footer class="documentation-footer">
                    <div class="footer-content">
                        <div class="footer-copyright">
                            <p>&copy; 2024 The Tech Idea - Beep.Python.DataManagement Documentation</p>
                        </div>
                        <div class="footer-links">
                            <a href="../index.html">Home</a>
                            <a href="../getting-started.html">Getting Started</a>
                            <a href="../api/PythonPandasManager.html">API Reference</a>
                        </div>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="../assets/navigation.js"></script>
</body>
</html>