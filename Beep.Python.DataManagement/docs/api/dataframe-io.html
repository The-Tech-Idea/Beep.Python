<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataFrame I/O Operations - Beep.Python.DataManagement</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet">
    <link href="../assets/styles.css" rel="stylesheet">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="bi bi-sun-fill" id="theme-icon"></i>
    </button>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Navigation will be loaded dynamically by navigation.js -->
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb Navigation -->
                <div class="breadcrumb-nav">
                    <a href="../index.html">Home</a>
                    <span>?</span>
                    <a href="../index.html#core-api">Core API</a>
                    <span>?</span>
                    <span>DataFrame I/O</span>
                </div>

                <!-- Page Header -->
                <div class="page-header">
                    <h1><i class="bi bi-arrow-down-up"></i> DataFrame I/O Operations</h1>
                    <p class="page-subtitle">Complete guide to loading and saving data with comprehensive format support and performance optimization</p>
                </div>

                <!-- Overview -->
                <section class="section" id="overview">
                    <h2>?? Supported Formats</h2>
                    
                    <div class="feature-grid">
                        <div class="feature-card">
                            <h4><i class="bi bi-file-earmark-text"></i> CSV Files</h4>
                            <p>Most common format with flexible parsing options and async support</p>
                            <small>ReadCsv, ToCsv, ReadCsvAsync, ToCsvAsync</small>
                        </div>
                        
                        <div class="feature-card">
                            <h4><i class="bi bi-file-earmark-excel"></i> Excel Files</h4>
                            <p>Support for .xlsx and .xls files with sheet selection</p>
                            <small>ReadExcel, ToExcel</small>
                        </div>
                        
                        <div class="feature-card">
                            <h4><i class="bi bi-braces"></i> JSON Files</h4>
                            <p>Structured data with nested object support</p>
                            <small>ReadJson, ToJson, GetDataFrameAsJson</small>
                        </div>
                        
                        <div class="feature-card">
                            <h4><i class="bi bi-server"></i> Databases</h4>
                            <p>Direct SQL query execution with connection management</p>
                            <small>ReadSql</small>
                        </div>
                        
                        <div class="feature-card">
                            <h4><i class="bi bi-globe"></i> Web APIs</h4>
                            <p>Load data directly from web URLs and REST APIs</p>
                            <small>ReadFromWeb</small>
                        </div>
                        
                        <div class="feature-card">
                            <h4><i class="bi bi-gear"></i> Generic Export</h4>
                            <p>Support for Parquet, HDF5, and other formats</p>
                            <small>ExportDataFrame</small>
                        </div>
                    </div>
                </section>

                <!-- CSV Operations -->
                <section class="section" id="csv-operations">
                    <h2>?? CSV Operations</h2>
                    
                    <div class="code-example">
                        <h4>Basic CSV Loading</h4>
                        <pre><code class="language-csharp">// Simple CSV loading
pandasManager.ReadCsv("sales_data", @"C:\Data\sales.csv");

// Check what we loaded
string info = pandasManager.Describe("sales_data");
Console.WriteLine($"Loaded CSV data:\n{info}");</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>Async CSV Operations (Recommended for Large Files)</h4>
                        <pre><code class="language-csharp">// Async loading with cancellation support
var cancellationTokenSource = new CancellationTokenSource();

try
{
    await pandasManager.ReadCsvAsync("large_dataset", @"C:\BigData\huge_file.csv", cancellationTokenSource.Token);
    Console.WriteLine("? Large file loaded successfully");
}
catch (OperationCanceledException)
{
    Console.WriteLine("?? Load operation was cancelled");
}
catch (Exception ex)
{
    Console.WriteLine($"? Load failed: {ex.Message}");
}

// Async saving
await pandasManager.ToCsvAsync("processed_data", @"C:\Output\results.csv");</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>Advanced CSV Options (via pandas parameters)</h4>
                        <pre><code class="language-csharp">// For advanced CSV options, you can execute pandas code directly
string csvLoadCommand = @"
import pandas as pd
data = pd.read_csv(r'C:\Data\complex.csv', 
                   sep=';',           # Different separator
                   encoding='utf-8',  # Specify encoding
                   skiprows=1,        # Skip header rows
                   na_values=['N/A', 'NULL', ''],  # Custom missing values
                   parse_dates=['date_column'],     # Parse date columns
                   index_col='id')    # Set index column
";

// Execute the custom load command
var executeManager = pandasManager.GetExecuteManager(); // You'd need to expose this
executeManager.ExecutePythonCode(csvLoadCommand);</code></pre>
                    </div>
                </section>

                <!-- Excel Operations -->
                <section class="section" id="excel-operations">
                    <h2>?? Excel Operations</h2>
                    
                    <div class="code-example">
                        <h4>Excel File Loading</h4>
                        <pre><code class="language-csharp">// Load Excel file (first sheet by default)
pandasManager.ReadExcel("product_data", @"C:\Data\products.xlsx");

// Check the data
string productInfo = pandasManager.Describe("product_data");
Console.WriteLine($"Product data summary:\n{productInfo}");

// Get unique product categories
string categories = pandasManager.UniqueValues("product_data", "Category");
Console.WriteLine($"Product categories: {categories}");</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>Excel Export with Formatting</h4>
                        <pre><code class="language-csharp">// Basic Excel export
pandasManager.ToExcel("sales_summary", @"C:\Reports\sales_report.xlsx");

// For advanced Excel features, use pandas directly
string excelExportCommand = @"
# Advanced Excel export with multiple sheets
with pd.ExcelWriter(r'C:\Reports\comprehensive_report.xlsx', engine='openpyxl') as writer:
    sales_summary.to_excel(writer, sheet_name='Sales Summary', index=False)
    customer_data.to_excel(writer, sheet_name='Customers', index=False)
    regional_analysis.to_excel(writer, sheet_name='Regional Analysis', index=False)
";

// Execute advanced export
executeManager.ExecutePythonCode(excelExportCommand);</code></pre>
                    </div>
                </section>

                <!-- Database Operations -->
                <section class="section" id="database-operations">
                    <h2>??? Database Operations</h2>
                    
                    <div class="code-example">
                        <h4>SQL Server Integration</h4>
                        <pre><code class="language-csharp">// Load data from SQL Server
string connectionString = "Server=localhost;Database=SalesDB;Trusted_Connection=true;";
string query = @"
    SELECT 
        CustomerID, 
        CustomerName, 
        OrderDate, 
        TotalAmount,
        Region
    FROM Orders 
    WHERE OrderDate >= '2024-01-01'
    ORDER BY OrderDate DESC
";

pandasManager.ReadSql("recent_orders", query, connectionString);

// Analyze the loaded data
string orderStats = pandasManager.Describe("recent_orders");
Console.WriteLine($"Recent orders analysis:\n{orderStats}");

// Group by region
pandasManager.GroupBy("recent_orders", "orders_by_region", "Region", "sum");
string regionalData = pandasManager.GetDataFrameAsJson("orders_by_region");
Console.WriteLine($"Regional summary:\n{regionalData}");</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>PostgreSQL and MySQL</h4>
                        <pre><code class="language-csharp">// PostgreSQL connection
string postgresConnectionString = "Host=localhost;Database=analytics;Username=analyst;Password=secret;";
string postgresQuery = "SELECT * FROM user_analytics WHERE created_date >= current_date - interval '30 days'";

pandasManager.ReadSql("postgres_data", postgresQuery, postgresConnectionString);

// MySQL connection
string mysqlConnectionString = "Server=localhost;Database=ecommerce;Uid=root;Pwd=password;";
string mysqlQuery = "SELECT product_id, product_name, price, category FROM products WHERE active = 1";

pandasManager.ReadSql("mysql_products", mysqlQuery, mysqlConnectionString);</code></pre>
                    </div>
                </section>

                <!-- Web Data Loading -->
                <section class="section" id="web-operations">
                    <h2>?? Web Data Operations</h2>
                    
                    <div class="code-example">
                        <h4>Load Data from URLs</h4>
                        <pre><code class="language-csharp">// Load CSV from a web URL
string dataUrl = "https://raw.githubusercontent.com/datasets/country-list/master/data.csv";
pandasManager.ReadFromWeb("country_data", dataUrl);

// Check what we got
string countryInfo = pandasManager.Describe("country_data");
Console.WriteLine($"Country data:\n{countryInfo}");

// Get list of all countries
string countries = pandasManager.UniqueValues("country_data", "Name");
Console.WriteLine($"Countries: {countries}");</code></pre>
                    </div>

                    <div class="code-example">
                        <h4>API Data Integration</h4>
                        <pre><code class="language-csharp">// For complex API integration, use pandas with requests
string apiDataCommand = @"
import pandas as pd
import requests
import json

# Fetch data from REST API
response = requests.get('https://api.example.com/data', 
                       headers={'Authorization': 'Bearer YOUR_TOKEN'})

if response.status_code == 200:
    api_data = response.json()
    df = pd.DataFrame(api_data['results'])
    
    # Process the API data
    df['created_date'] = pd.to_datetime(df['created_date'])
    df = df.sort_values('created_date')
    
    # Make it available to the manager
    globals()['api_dataset'] = df
    print(f'Loaded {len(df)} records from API')
else:
    print(f'API request failed: {response.status_code}')
";

executeManager.ExecutePythonCode(apiDataCommand);</code></pre>
                    </div>
                </section>

                <!-- JSON Operations -->
                <section class="section" id="json-operations">
                    <h2>?? JSON Operations</h2>
                    
                    <div class="code-example">
                        <h4>JSON File Operations</h4>
                        <pre><code class="language-csharp">// Load JSON file
pandasManager.ReadJson("config_data", @"C:\Config\settings.json");

// Export to JSON
pandasManager.ToJson("analysis_results", @"C:\Output\results.json");

// Get DataFrame as JSON string for web APIs
string jsonData = pandasManager.GetDataFrameAsJson("customer_summary");

// Use in web API response
return Ok(new { 
    success = true, 
    data = JsonSerializer.Deserialize(jsonData),
    timestamp = DateTime.UtcNow 
});</code></pre>
                    </div>
                </section>

                <!-- Performance Optimization -->
                <section class="section" id="performance-optimization">
                    <h2>? Performance Optimization</h2>
                    
                    <div class="tip">
                        <h4>?? Large File Strategies</h4>
                        
                        <div class="code-example">
                            <h5>1. Use Async Methods</h5>
                            <pre><code class="language-csharp">// Always use async for files > 10MB
var fileInfo = new FileInfo(filePath);
if (fileInfo.Length > 10 * 1024 * 1024) // 10MB
{
    await pandasManager.ReadCsvAsync("large_data", filePath);
}
else
{
    pandasManager.ReadCsv("data", filePath);
}</code></pre>
                        </div>

                        <div class="code-example">
                            <h5>2. Sample Large Datasets</h5>
                            <pre><code class="language-csharp">// Load full dataset
await pandasManager.ReadCsvAsync("full_dataset", "huge_file.csv");

// Create sample for quick exploration
pandasManager.SampleDataFrame("full_dataset", "sample_data", 0.1); // 10% sample

// Develop your analysis on the sample first
string sampleStats = pandasManager.Describe("sample_data");
Console.WriteLine($"Sample statistics (10% of data):\n{sampleStats}");

// Apply analysis to full dataset once perfected
pandasManager.GroupBy("full_dataset", "full_analysis", "category", "sum");</code></pre>
                        </div>

                        <div class="code-example">
                            <h5>3. Optimize Memory Usage</h5>
                            <pre><code class="language-csharp">// Monitor memory before loading large files
string memoryBefore = pandasManager.GetMemoryUsageReport();
Console.WriteLine($"Memory before load:\n{memoryBefore}");

// Load data
await pandasManager.ReadCsvAsync("big_data", "large_file.csv");

// Optimize data types to reduce memory usage
pandasManager.OptimizeMemory("big_data");

// Check memory after optimization
string memoryAfter = pandasManager.GetMemoryUsageReport();
Console.WriteLine($"Memory after optimization:\n{memoryAfter}");

// Clean up unused DataFrames
pandasManager.CleanupIdleDataFrames(5); // Clean DataFrames older than 5 minutes</code></pre>
                        </div>
                    </div>
                </section>

                <!-- Error Handling -->
                <section class="section" id="error-handling">
                    <h2>??? Error Handling Best Practices</h2>
                    
                    <div class="code-example">
                        <h4>Robust File Loading</h4>
                        <pre><code class="language-csharp">public static async Task&lt;bool&gt; SafeLoadData(IPythonPandasManager pandasManager, 
                                                    string dataFrameName, 
                                                    string filePath)
{
    try
    {
        // 1. Validate file exists
        if (!File.Exists(filePath))
        {
            Console.WriteLine($"? File not found: {filePath}");
            return false;
        }

        // 2. Check file size
        var fileInfo = new FileInfo(filePath);
        Console.WriteLine($"?? File size: {fileInfo.Length / (1024 * 1024):F1} MB");

        // 3. Determine load strategy based on size
        bool useAsync = fileInfo.Length > 10 * 1024 * 1024; // 10MB threshold

        // 4. Load with appropriate method
        if (useAsync)
        {
            Console.WriteLine("? Loading large file asynchronously...");
            await pandasManager.ReadCsvAsync(dataFrameName, filePath);
        }
        else
        {
            Console.WriteLine("? Loading file...");
            pandasManager.ReadCsv(dataFrameName, filePath);
        }

        // 5. Verify load success
        string description = pandasManager.Describe(dataFrameName);
        if (string.IsNullOrEmpty(description))
        {
            Console.WriteLine("? Load appeared to succeed but no data found");
            return false;
        }

        Console.WriteLine($"? Successfully loaded: {dataFrameName}");
        Console.WriteLine($"?? Basic info:\n{description}");
        
        return true;
    }
    catch (UnauthorizedAccessException)
    {
        Console.WriteLine($"? Access denied to file: {filePath}");
        return false;
    }
    catch (FileNotFoundException)
    {
        Console.WriteLine($"? File not found: {filePath}");
        return false;
    }
    catch (Exception ex)
    {
        Console.WriteLine($"? Unexpected error loading {filePath}: {ex.Message}");
        return false;
    }
}</code></pre>
                    </div>
                </section>

                <!-- Navigation Links -->
                <div class="nav-links">
                    <a href="IPythonPandasManager.html" class="btn-beep">
                        <i class="bi bi-arrow-left"></i> Interface Reference
                    </a>
                    <a href="data-manipulation.html" class="btn-beep">
                        <i class="bi bi-arrow-right"></i> Data Manipulation
                    </a>
                </div>

                <!-- Footer -->
                <footer class="documentation-footer">
                    <div class="footer-content">
                        <div class="footer-copyright">
                            <p>&copy; 2024 The Tech Idea - Beep.Python.DataManagement Documentation</p>
                        </div>
                        <div class="footer-links">
                            <a href="../index.html">Home</a>
                            <a href="../getting-started.html">Getting Started</a>
                            <a href="PythonPandasManager.html">API Reference</a>
                        </div>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="../assets/navigation.js"></script>
</body>
</html>