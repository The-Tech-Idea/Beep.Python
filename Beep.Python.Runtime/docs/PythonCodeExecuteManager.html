<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PythonCodeExecuteManager - Beep.Python.Runtime.PythonNet</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Theme Toggle -->
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <i class="bi bi-sun-fill" id="theme-icon"></i>
    </button>

    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <!-- Navigation will be loaded dynamically by navigation.js -->
        </aside>

        <!-- Main Content -->
        <main class="content">
            <div class="content-wrapper">
                <!-- Breadcrumb -->
                <nav class="breadcrumb-nav">
                    <a href="index.html">Home</a>
                    <span>?</span>
                    <a href="#">Core Classes</a>
                    <span>?</span>
                    <span>Python Code Execute Manager</span>
                </nav>

                <!-- Page Header -->
                <div class="page-header">
                    <h1>? PythonCodeExecuteManager</h1>
                    <p class="page-subtitle">Advanced code execution engine with async support, output capture, and error handling</p>
                </div>

                <!-- Class Info -->
                <div class="class-info">
                    <div class="class-namespace">namespace <strong>Beep.Python.RuntimeEngine</strong></div>
                    <p>Manages Python code execution with optimizations for multiuser environments, output capturing, and error handling.</p>
                    <div class="class-implements">
                        Implements: <code>IDisposable</code>, <code>IPythonCodeExecuteManager</code>
                    </div>
                </div>

                <!-- Table of Contents -->
                <div class="toc">
                    <h3>?? Table of Contents</h3>
                    <ul>
                        <li><a href="#overview">Overview</a></li>
                        <li><a href="#properties">Properties</a></li>
                        <li><a href="#methods">Methods</a></li>
                        <li><a href="#usage-examples">Usage Examples</a></li>
                        <li><a href="#see-also">See Also</a></li>
                    </ul>
                </div>

                <!-- Overview -->
                <section class="section" id="overview">
                    <h2>Overview</h2>
                    <p>
                        The <code>PythonCodeExecuteManager</code> provides a robust way to execute Python code within a .NET application. 
                        It manages the complexities of Python's Global Interpreter Lock (GIL), captures stdout/stderr output, 
                        handles errors gracefully, and supports both synchronous and asynchronous execution patterns.
                    </p>
                    
                    <p>
                        This class is designed to work with session-based Python execution, where each session has its own 
                        isolated Python scope. It includes features like timeout handling, cancellation support, and variable passing 
                        between .NET and Python.
                    </p>
                </section>

                <!-- Properties -->
                <section class="section" id="properties">
                    <h2>Properties</h2>
                    <ul class="member-list">
                        <li>
                            <div class="member-name">IsExecuting</div>
                            <div class="member-type">bool</div>
                            <div class="member-desc">Gets a value indicating whether any Python code is currently executing.</div>
                        </li>
                        
                        <li>
                            <div class="member-name">Progress</div>
                            <div class="member-type">IProgress&lt;PassedArgs&gt;</div>
                            <div class="member-desc">Gets or sets the progress reporter for Python code execution.</div>
                        </li>
                        
                        <li>
                            <div class="member-name">CancellationToken</div>
                            <div class="member-type">CancellationToken</div>
                            <div class="member-desc">Gets or sets the cancellation token for stopping operations.</div>
                        </li>
                    </ul>
                </section>

                <!-- Methods -->
                <section class="section" id="methods">
                    <h2>Methods</h2>
                    
                    <h3>Code Execution Methods</h3>
                    <ul class="member-list">
                        <li>
                            <div class="member-name">ExecuteCodeAsync(string code, PythonSessionInfo session, int timeoutSeconds = 120, IProgress&lt;PassedArgs&gt; progress = null)</div>
                            <div class="member-type">Task&lt;(bool Success, string Output)&gt;</div>
                            <div class="member-desc">
                                Executes Python code asynchronously with output capturing and error handling.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">ExecuteScriptFileAsync(string filePath, PythonSessionInfo session, int timeoutSeconds = 300, IProgress&lt;PassedArgs&gt; progress = null)</div>
                            <div class="member-type">Task&lt;(bool Success, string Output)&gt;</div>
                            <div class="member-desc">
                                Executes a Python script file asynchronously within a session.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">ExecuteCommandAsync(string command, PythonSessionInfo session, IProgress&lt;PassedArgs&gt; progress = null)</div>
                            <div class="member-type">Task&lt;object&gt;</div>
                            <div class="member-desc">
                                Executes a Python command and returns the result.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">ExecuteWithVariablesAsync(string code, PythonSessionInfo session, Dictionary&lt;string, object&gt; variables, IProgress&lt;PassedArgs&gt; progress = null)</div>
                            <div class="member-type">Task&lt;object&gt;</div>
                            <div class="member-desc">
                                Executes Python code with multiple inputs/variables and returns the result.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">ExecuteCodeWithProfilingAsync(string code, PythonSessionInfo session, int timeoutSeconds = 120, IProgress&lt;PassedArgs&gt; progress = null)</div>
                            <div class="member-type">Task&lt;(bool Success, string Output, TimeSpan ExecutionTime)&gt;</div>
                            <div class="member-desc">
                                Executes Python code with performance profiling information.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">StopExecution()</div>
                            <div class="member-type">void</div>
                            <div class="member-desc">
                                Stops any currently executing Python code.
                            </div>
                        </li>
                    </ul>
                    
                    <h3>Advanced Execution Methods</h3>
                    <ul class="member-list">
                        <li>
                            <div class="member-name">ExecuteBatchAsync(IList&lt;string&gt; commands, PythonSessionInfo session, IProgress&lt;PassedArgs&gt; progress = null)</div>
                            <div class="member-type">Task&lt;List&lt;object&gt;&gt;</div>
                            <div class="member-desc">
                                Executes Python code in a batch, optimizing GIL usage.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">ExecuteGeneratorAsync(string generatorCode, string functionName, PythonSessionInfo session, Action&lt;object&gt; onItemYielded, IProgress&lt;PassedArgs&gt; progress = null)</div>
                            <div class="member-type">Task&lt;bool&gt;</div>
                            <div class="member-desc">
                                Executes Python code that returns an iterator or generator, processing items as they are yielded.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">ExecuteInteractiveAsync(IList&lt;string&gt; codeSegments, PythonSessionInfo session, bool stopOnError = false, IProgress&lt;PassedArgs&gt; progress = null)</div>
                            <div class="member-type">Task&lt;List&lt;(bool Success, string Output)&gt;&gt;</div>
                            <div class="member-desc">
                                Executes Python code in interactive mode, allowing for incremental execution.
                            </div>
                        </li>
                    </ul>
                    
                    <h3>Helper Methods</h3>
                    <ul class="member-list">
                        <li>
                            <div class="member-name">ToPython(IDictionary&lt;string, object&gt; dictionary)</div>
                            <div class="member-type">PyObject</div>
                            <div class="member-desc">
                                Converts a C# dictionary to a Python dictionary object.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">ToPython(object obj)</div>
                            <div class="member-type">PyObject</div>
                            <div class="member-desc">
                                Converts an arbitrary C# object to a PyObject.
                            </div>
                        </li>
                        
                        <li>
                            <div class="member-name">CleanupSession(string sessionId)</div>
                            <div class="member-type">void</div>
                            <div class="member-desc">
                                Cleans up session resources when a session is no longer needed.
                            </div>
                        </li>
                    </ul>
                </section>

                <!-- Usage Examples -->
                <section class="section" id="usage-examples">
                    <h2>Usage Examples</h2>
                    
                    <div class="code-example">
                        <h3>Basic Code Execution</h3>
                        <pre><code class="language-csharp">// Assuming runtimeManager is already initialized
var executeManager = runtimeManager.ExecuteManager;
var session = runtimeManager.GetOrCreateDefaultSession();

// Execute Python code and get output
var result = await executeManager.ExecuteCodeAsync(
    @"import sys
print(f'Python version: {sys.version}')
print('Hello from Python!')",
    session);

// Check execution result
if (result.Success)
{
    Console.WriteLine("Python output:");
    Console.WriteLine(result.Output);
}
else
{
    Console.WriteLine("Execution failed:");
    Console.WriteLine(result.Output);
}</code></pre>
                    </div>
                    
                    <div class="code-example">
                        <h3>Passing Variables Between .NET and Python</h3>
                        <pre><code class="language-csharp">// Create .NET data to pass to Python
var data = new Dictionary&lt;string, object&gt;
{
    ["name"] = "John",
    ["age"] = 30,
    ["items"] = new List&lt;string&gt; { "apple", "banana", "cherry" }
};

// Execute Python code with the .NET variables
var result = await executeManager.ExecuteWithVariablesAsync(
    @"
# Use the .NET variables
print(f'Hello {name}, you are {age} years old')
print(f'Your items: {", ".join(items)}')

# Create a result to return to .NET
result = {
    'message': f'Processed data for {name}',
    'item_count': len(items),
    'doubled_age': age * 2
}
",
    session,
    data);

// The Python result is available as a dynamic object
dynamic pythonResult = result;
Console.WriteLine(pythonResult.message);
Console.WriteLine($"Items: {pythonResult.item_count}");
Console.WriteLine($"Doubled age: {pythonResult.doubled_age}");</code></pre>
                    </div>
                    
                    <div class="code-example">
                        <h3>Working with Python Generators</h3>
                        <pre><code class="language-csharp">// Define a Python generator function
string generatorCode = @"
def generate_fibonacci(count):
    """Generate the first n Fibonacci numbers"""
    a, b = 0, 1
    for _ in range(count):
        yield a
        a, b = b, a + b
";

// Set up a callback to process each yielded value
var fibNumbers = new List&lt;int&gt;();
Action&lt;object&gt; processItem = (item) => {
    int number = Convert.ToInt32(item);
    fibNumbers.Add(number);
    Console.WriteLine($"Received Fibonacci number: {number}");
};

// Execute the generator
bool success = await executeManager.ExecuteGeneratorAsync(
    generatorCode, 
    "generate_fibonacci", 
    session,
    processItem);

// The fibNumbers list now contains all generated values
Console.WriteLine($"Generated {fibNumbers.Count} Fibonacci numbers");</code></pre>
                    </div>
                </section>

                <!-- See Also -->
                <section class="section" id="see-also">
                    <h2>See Also</h2>
                    <ul>
                        <li><a href="PythonNetRunTimeManager.html">PythonNetRunTimeManager</a> - For managing the Python runtime</li>
                        <li><a href="PythonSessionManager.html">PythonSessionManager</a> - For managing Python sessions</li>
                        <li><a href="package-management.html">Package Management</a> - Advanced package installation and management</li>
                    </ul>
                </section>

                <!-- Navigation Links -->
                <div class="nav-links">
                    <a href="PythonSessionManager.html">
                        <i class="bi bi-arrow-left"></i> PythonSessionManager
                    </a>
                    <a href="PythonVirtualEnvManager.html">
                        <i class="bi bi-arrow-right"></i> PythonVirtualEnvManager
                    </a>
                </div>

                <!-- Footer -->
                <footer class="documentation-footer">
                    <div class="footer-content">
                        <div class="footer-copyright">
                            <p>&copy; 2024 The Tech Idea - Beep.Python.Runtime.PythonNet Documentation</p>
                        </div>
                        <div class="footer-links">
                            <a href="index.html">Home</a>
                            <a href="api-reference.html">API Reference</a>
                        </div>
                    </div>
                </footer>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="navigation.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
</body>
</html>
